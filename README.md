# 科技感点名器

基于 Flask 和 Chart.js 的随机点名系统，支持 Excel/TXT 导入、历史记录和数据统计可视化。

## 🎯 功能特性

- 📊 **智能点名** - 基于权重算法，被点次数少的学生概率更高
- 📁 **批量导入** - 支持 Excel (.xlsx/.xls) 和 TXT 文件导入学生名单
- 📝 **历史记录** - 自动记录每次点名的时间和结果，保留最近 50 条记录
- 📈 **数据统计** - 可视化图表展示每个学生的被点次数
- 🎨 **科技感界面** - 现代化设计，带有加载动画和动态效果

## 🛠 技术栈

- **后端**: Python + Flask
- **前端**: HTML5 + JavaScript (Chart.js)
- **数据处理**: pandas + openpyxl
- **存储**: JSON (本地)

## 📦 安装依赖

```bash
pip install -r requirements.txt
```

依赖项：
- Flask==2.0.1
- pandas==1.3.3
- openpyxl==3.0.9
- Werkzeug==2.0.1

## 🚀 快速启动

```bash
python app.py
```

访问 `http://localhost:5000` 即可使用。

## 📋 使用说明

1. **导入学生名单**
   - 点击"选择文件"按钮，上传 Excel 或 TXT 格式的学生名单
   - Excel 文件第一列应为学生姓名
   - TXT 文件每行一个学生姓名

2. **开始点名**
   - 点击"开始点名"按钮
   - 系统会随机选择一名学生（已点次数少的概率更高）

3. **查看统计**
   - 底部显示学生总数、总点名次数和平均被点次数
   - 柱状图展示 TOP10 学生的被点次数

4. **清空数据**
   - 点击"清空数据"按钮可重置所有数据（不可恢复）

## 📂 项目结构

```
Roll-call-device1/
├── app.py              # Flask 后端主程序
├── requirements.txt    # Python 依赖
├── data/              # 数据存储目录
│   ├── students.json  # 学生数据（姓名、被点次数）
│   └── history.json   # 点名历史记录
├── templates/         # HTML 模板
│   └── index.html     # 前端主页面
└── static/            # 静态资源
    ├── css/
    │   └── style.css  # 样式文件
    └── js/
        └── main.js    # 前端逻辑
```

## 🔄 点名算法

采用加权随机算法，权重计算公式：
```
权重 = 1 / (被点次数 + 1)
```

被点次数越少的学生，被选中的概率越高，确保公平性。

## 📄 文件格式说明

### Excel 格式
- 支持 `.xlsx` 和 `.xls`
- 第一列为学生姓名

### TXT 格式
- 每行一个学生姓名
- 编码为 UTF-8

## 💡 注意事项

- 首次运行会自动创建 `data` 目录和数据文件
- 历史记录仅保留最近 50 条
- 清空数据操作不可恢复，请谨慎使用
- 本系统采用本地存储，数据不会上传到任何服务器
